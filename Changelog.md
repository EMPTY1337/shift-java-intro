50 строка: используется while (current < max), чтобы включить крайнее значение.